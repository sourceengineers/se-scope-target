# Embedded example
This example should illustrate, how the library can be compiled and used for embedded targets.

The library got compiled with CMake for a arm Nucleo L476 target, and got used in a Atollic project.
The project itself was generated with the help of the MXCube.

The example itself will not compile as it is in the repository, since not all arm specific libraries got copied committed.
# Library compilation
This section will explain how to compile the library for an arm target.
It is the same as in the doc/build-\* documentations, with the difference, that this example should also shows how the toolchain has to be defined and how the compiler flags have to be set.
# Build procedure
1. Follow the process described in the doc/build-\* documentations, about compiling for embedded targets, until you reach the section where you have to generate the makefile with the cmake command.
2. This is where you have to define the toolchain to specify compilers and environments for the specific target. The atollic-toolchain.cmake toolchain was used to compile the library in this case.
3. If the toolchain is defined, run the cmake command as follows:
```bash
cmake -DARCHITECTURE=EMBEDDED -DCMAKE_TOOLCHAIN_FILE=$HOME/Desktop/atollic-toolchain.cmake  -DCMAKE_C_FLAGS="-mcpu=cortex-m4 -Wall -fdata-sections -ffunction-sections -DUSE_HAL_DRIVER -DSTM32L476xx -mthumb -mfpu=fpv4-sp-d16 -mfloat-abi=hard" ..
```
These are all flags, specific for to the target platform. The flags were generated by the MXCube and copied over.
4. After this step, follow the instructions again as given. Once they are installed, with make install, the library can be included and used in your project with:
```c
#include <Gemmi.h>
```
